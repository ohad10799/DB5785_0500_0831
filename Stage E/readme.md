**Hotel Management System - README**

**[[מגישים]{.underline}: אוהד כחלון ומאיר רביבו]{dir="rtl"}**\
**[[היחידה הנבחרת]{.underline}: ניהול אורחים]{dir="rtl"}**

**[[תוכן העניינים]{.underline}]{dir="rtl"}**

[[שלב א\' - יצירת מסד הנתונים]{.underline}]{dir="rtl"}

1.  [מבוא]{dir="rtl"}

2.  Entity-Relationship Diagram (ERD)

3.  Data Structure Diagram (DSD)

4.  [שיטות להכנסת נתונים]{dir="rtl"}

5.  Backup and Restore

[[שלב ב\' - שאילתות בסיסיות ומתקדמות]{.underline}]{dir="rtl"}

6.  Queries

7.  Constraints

8.  Rollback and Commit

[[שלב ג\' - אינטגרציה]{.underline}]{dir="rtl"}

9.  [תרשימי]{dir="rtl"} DSD [ו־]{dir="rtl"}ERD [- צילומי מסך]{dir="rtl"}

10. [הסבר על החלטות בתהליך האינטגרציה]{dir="rtl"}

11. [תהליך האינטגרציה - הסבר מילולי עם פקודות]{dir="rtl"}

12. [מבטים (]{dir="rtl"}Views[)]{dir="rtl"}

13. [תיאור כל מבט]{dir="rtl"}

14. [פלט של כל מבט]{dir="rtl"}

15. [שאילתות על מבטים]{dir="rtl"}

16. [הסבר מילולי של כל שאילתא]{dir="rtl"}

17. [קוד]{dir="rtl"} SQL

18. [פלט שאילתא]{dir="rtl"}

[[שלב ד\' - פונקציות, פרוצדורות וטריגרים:]{.underline}]{dir="rtl"}

19. [עבור כל תוכנית (פונקציה / פרוצדורה / טריגר):]{dir="rtl"}

20. [תיאור מילולי של מטרת הקוד]{dir="rtl"}

21. [קוד מלא של הפונקציה / הפרוצדורה / הטריגר]{dir="rtl"}

22. [צילום מסך של ההפעלה]{dir="rtl"}

[[שלב ה\' - ממשק גרפי:]{dir="rtl"}]{.underline}

23. [הוראות הפעלה של האפליקציה]{dir="rtl"}

24. [הסבר על דרך העבודה]{dir="rtl"}

25. [מסכים עיקריים במערכת]{dir="rtl"}

26. [צילומי מסך מכל אחד מהמסכים בפעולה]{dir="rtl"}

**[[מבוא:]{.underline}]{dir="rtl"}**

[מערכת ניהול המלון שבנינו נועדה לנהל בצורה יעילה ומרוכזת את המידע
והתהליכים הקשורים לאורחי המלון. המערכת כוללת מגוון רכיבים שמכסים את
התחומים המרכזיים של פעילות המלון: ניהול אורחים, תלונות, פידבקים
והזמנות.]{dir="rtl"}

[באמצעות הממשק הגרפי שפותח, ניתן לבצע פעולות כמו הוספה ומחיקה של הזמנות,
בדיקת זמינות חדרים, צפייה בתלונות של אורחים וניהול הטיפול בהן, קבלת
פידבקים והענקת תגמולים לאורחים מרוצים. כל המידע מנוהל בבסיס נתונים
מאורגן, שמבטיח עקביות, שלמות ועדכניות.]{dir="rtl"}

[המטרה המרכזית של המערכת היא לייעל את תהליך העבודה של צוות הקבלה
והשירות, לאפשר שליטה ובקרה על כל ההיבטים של התקשורת עם האורחים, ולשפר את
שביעות רצונם על ידי תגובה מהירה ויעילה לכל פנייה, הזמנה או
בעיה]{dir="rtl"}.

**Entity-Relationship Diagram (ERD)**

![](media/image1.png){width="5.768055555555556in"
height="3.8916666666666666in"}

**Data Structure Diagram (DSD)**

![](media/image2.png){width="5.768055555555556in"
height="2.2708333333333335in"}

**Data input methods**

> **First tool: using [mockaro](https://www.mockaroo.com/)o to create
> csv file**
>
> **Entering a data to guest table:**
>
> ![](media/image3.png){width="5.768055555555556in"
> height="1.9444444444444444in"}
>
> ![](media/image4.png){width="5.768055555555556in"
> height="3.109027777777778in"}
>
> **Second tool:
> using [generatedata](https://generatedata.com/generator). to create
> csv file**
>
> **Entering a data to incidentType table:**
>
> ![](media/image5.png){width="5.768055555555556in"
> height="1.2590277777777779in"}
> ![](media/image6.png){width="4.46696741032371in"
> height="2.807853237095363in"}
>
> **Third tool: using python to create csv file**
>
> **Part of Python code:**
>
> ![](media/image7.png){width="5.768055555555556in"
> height="2.4180555555555556in"}
>
> **Sql file made from the python script:**
>
> ![](media/image8.png){width="3.1223600174978126in"
> height="3.62834208223972in"}

**Backup**

-   **backups files are kept with the date of the backup:**

> ![](media/image9.png){width="5.768055555555556in"
> height="0.22291666666666668in"}

**Queries**

> **Select:**

1)  [רשימת האורחים שהיו להם תקריות פתוחות, ופרטי התקרית ביחד עם פרטי
    האורח]{dir="rtl"}

> ![](media/image10.png){width="5.768055555555556in"
> height="0.8423611111111111in"}
>
> ![](media/image11.png){width="5.768055555555556in"
> height="1.3895833333333334in"}

2)  [מספר ההזמנות לפי סוג חדר]{dir="rtl"}

![](media/image12.png){width="5.768055555555556in"
height="1.2180555555555554in"}

![](media/image13.png){width="4.083903105861768in"
height="2.5628576115485564in"}

3)  [כל המשובים מתחת לדירוג 3 שנכתבו בחודשים שונים]{dir="rtl"}

![](media/image14.png){width="5.768055555555556in"
height="1.0506944444444444in"}![](media/image15.png){width="5.768055555555556in"
height="1.117361111111111in"}

[]{dir="rtl"}

4)  [מספר הלילות שכל אורח שהה במלון]{dir="rtl"}

![](media/image16.png){width="4.520833333333333in"
height="2.3854166666666665in"}![תמונה שמכילה טקסט, גופן, צילום מסך, קו
תוכן שנוצר על-ידי בינה מלאכותית עשוי להיות
שגוי.](media/image17.png){width="5.768055555555556in"
height="1.1020833333333333in"}

5)  [רשימת אורחים עם מנוי ברמה גבוהה מ7]{dir="rtl"}

![](media/image18.png){width="5.768055555555556in"
height="1.225in"}

![](media/image19.png){width="4.815972222222222in"
height="1.8458333333333334in"}

[]{dir="rtl"}

6)  [אורחים שהשאירו פידבק על יותר מהזמנה אחת]{dir="rtl"}

> ![](media/image20.png){width="4.865262467191601in"
> height="1.3231014873140858in"}![תמונה שמכילה טקסט, גופן, צילום מסך, קו
> תוכן שנוצר על-ידי בינה מלאכותית עשוי להיות
> שגוי.](media/image21.png){width="5.768055555555556in"
> height="1.4222222222222223in"}

7)  ![](media/image22.png){width="4.821531058617673in"
    height="2.723067585301837in"}[תאריכי הדיווחים לפי סוג
    התקרית]{dir="rtl"}

> ![](media/image23.png){width="4.836675415573054in"
> height="2.1359044181977254in"}

8)  [דירוג ממוצע של פידבק לפי רמת המנוי]{dir="rtl"}

> ![](media/image24.png){width="4.399071522309711in"
> height="2.338297244094488in"}

![](media/image25.png){width="4.727272528433946in"
height="1.606111111111111in"}

**Delete:**

1.  [מחיקת כל הפידבקים מתחת לדירוג 2]{dir="rtl"}

> ![תמונה שמכילה טקסט, גופן, עיצוב תוכן שנוצר על-ידי בינה מלאכותית עשוי
> להיות
> שגוי.](media/image26.png){width="3.021255468066492in"
> height="0.729268372703412in"}
>
> [מסד הנתונים לפני השינוי:]{dir="rtl"}
>
> ![](media/image27.png){width="5.768055555555556in"
> height="0.7326388888888888in"}
>
> [מסד הנתונים לאחר השינוי:]{dir="rtl"}
>
> ![](media/image28.png){width="5.768055555555556in"
> height="0.6243055555555556in"}

2.  [מחיקת מנויים שאין להם נקודות כלל]{dir="rtl"}

> ![](media/image29.png){width="3.771359361329834in"
> height="0.6563418635170604in"}

[מסד הנתונים לפני השינוי:]{dir="rtl"}

![תמונה שמכילה טקסט, צילום מסך, גופן, מספר תוכן שנוצר על-ידי בינה
מלאכותית עשוי להיות
שגוי.](media/image30.png){width="5.707620297462817in"
height="1.187351268591426in"}

[מסד הנתונים לאחר השינוי:]{dir="rtl"}

![תמונה שמכילה טקסט, צילום מסך, גופן, מספר תוכן שנוצר על-ידי בינה
מלאכותית עשוי להיות
שגוי.](media/image31.png){width="5.768055555555556in"
height="1.1576388888888889in"}

3.  [מחיקת תקריות שנסגרו לפני יותר משנה]{dir="rtl"}

> ![](media/image32.png){width="5.768055555555556in"
> height="2.138888888888889in"}[מסד הנתונים לפני השינוי:]{dir="rtl"}
>
> ![](media/image33.png){width="5.768055555555556in"
> height="0.7125in"}
>
> [מסד הנתונים לאחר השינוי:]{dir="rtl"}
>
> ![](media/image34.png){width="5.768055555555556in"
> height="0.9145833333333333in"}

**Update:**

1.  [עדכון סטטוס התקריות שגילן מעל חודש לסגורות]{dir="rtl"}

> ![](media/image35.png){width="5.768055555555556in"
> height="1.1041666666666667in"}

[מסד הנתונים לפני השינוי:]{dir="rtl"}

![](media/image36.png){width="5.768055555555556in"
height="1.125in"}

[מסד הנתונים לאחר השינוי:]{dir="rtl"}

![תמונה שמכילה טקסט, צילום מסך, גופן, מספר תוכן שנוצר על-ידי בינה
מלאכותית עשוי להיות
שגוי.](media/image37.png){width="5.768055555555556in"
height="1.101388888888889in"}

2.  [עדכון דירוג של פידבקים בלי תיאור לדירוג 3]{dir="rtl"}

> ![](media/image38.png){width="4.712377515310586in"
> height="0.8459142607174103in"}
>
> [מסד הנתונים לפני השינוי:]{dir="rtl"}
>
> ![](media/image39.png){width="5.768055555555556in"
> height="0.73125in"}

[מסד הנתונים לאחר השינוי:]{dir="rtl"}

![](media/image40.png){width="5.768055555555556in"
height="0.7423611111111111in"}

3.  ![](media/image41.png){width="5.768055555555556in"
    height="1.2069444444444444in"}[העלאת רמת המנוי לכל מי שיש לו מעל 80
    נקודות]{dir="rtl"}

[מסד הנתונים לפני השינוי:]{dir="rtl"}

![](media/image42.png){width="5.174471784776903in"
height="1.079623797025372in"}

[מסד הנתונים לאחר השינוי:]{dir="rtl"}

![](media/image43.png){width="4.965016404199475in"
height="0.9785072178477691in"}

1)  **Constraints:**

    1.  [חובה להכניס מספר טלפון לאורח]{dir="rtl"}

> ![](media/image44.png){width="5.457650918635171in"
> height="0.7394903762029746in"}
>
> [ניסיון הכנסת נתון שסותר את האילוץ:]{dir="rtl"}
>
> ![תמונה שמכילה טקסט, צילום מסך, גופן, תוכנה תוכן שנוצר על-ידי בינה
> מלאכותית עשוי להיות
> שגוי.](media/image45.png){width="5.768055555555556in"
> height="2.98125in"}

2.  [ברירת מחדל לסטטוס תקרית יהיה \'פתוח\']{dir="rtl"}

> ![](media/image46.png){width="5.082075678040245in"
> height="0.7341830708661418in"}

[ניסיון להכנסת נתונים:]{dir="rtl"}

![](media/image47.png){width="5.768055555555556in"
height="0.4625in"}

![](media/image49.png){width="5.768055555555556in"
height="0.2986111111111111in"}

3.  [אילוץ שתאריך הכניסה יהיה לפני תאריך היציאה]{dir="rtl"}

> ![](media/image50.png){width="4.909091207349081in"
> height="0.831894138232721in"}

[ניסיון להכנסת נתונים וסתירת האילוץ:]{dir="rtl"}

![](media/image51.png){width="5.768055555555556in"
height="2.9611111111111112in"}

2)  **Rollback and Commit:**

![](media/image52.png){width="5.768055555555556in"
height="2.3652777777777776in"}

[הנתונים לפני הטרנזקציה:]{dir="rtl"}

![](media/image53.png){width="5.768055555555556in"
height="0.6470592738407699in"}

[השינוי:]{dir="rtl"}

![](media/image54.png){width="5.768055555555556in"
height="0.6576388888888889in"}

[לאחר]{dir="rtl"} ROLLBACK[:]{dir="rtl"}

![](media/image55.png){width="5.768055555555556in"
height="0.6395833333333333in"}

![](media/image56.png){width="4.067361111111111in"
height="2.761111111111111in"}

[]{dir="rtl"}

[המצב לפני השינוי:]{dir="rtl"}

![](media/image57.png){width="5.768055555555556in"
height="0.6597222222222222in"}

[המצב אחרי השינוי:]{dir="rtl"}

![](media/image58.png){width="5.768055555555556in"
height="0.6763888888888889in"}

[המצב לאחר]{dir="rtl"} commit[:]{dir="rtl"}

![](media/image59.png){width="5.768055555555556in"
height="0.66875in"}

**[[שלב 3 -- אינטגרציה:]{.underline}]{dir="rtl"}**

[קיבלנו מסד נתונים של חדרים והזמנות. טבלת החדרים מקשרת בין מספר חדר לסוג
ולפרטים שלו, וטבלת ההזמנות (כמו טבלת ההזמנות במסד נתונים שלנו), מקשרת
בין מספר הזמנה למספר החדר המוזמן.]{dir="rtl"}

[במסד נתונים המשותף, נאחד את טבלאות ההזמנות של המסד המקורי ושל המסד
החדש. במסד החדש יש ערך]{dir="rtl"} RoomNumber [בתוך טבלת ההזמנות, בעוד
במסד שלנו יש ערך]{dir="rtl"} RoomType[. מכיוון שנוספת במסד המאוחד
טבלת]{dir="rtl"} Room [שמקשרת בין מסר החדר לבין הסוג שלו, נמחק את
הפרמטר]{dir="rtl"} RoomType [מטבלת ההזמנות לטובת הערך]{dir="rtl"}
RoomNumber[.]{dir="rtl"}

[למסדר המשותף נוסיף את טבלת]{dir="rtl"} Room [מהמסד החדש, ונקשר אותה
לטבלת ההזמנות הקיימת.]{dir="rtl"}

[תרשים]{dir="rtl"} ERD [של מסד הנתונים השני:]{dir="rtl"}

![](media/image60.png){width="5.274022309711286in"
height="1.6518985126859143in"}

[תרשים]{dir="rtl"} DSD [של מסד הנתונים השני:]{dir="rtl"}

![](media/image61.png){width="5.33330271216098in"
height="1.3788232720909885in"}

![](media/image62.png){width="5.768055555555556in"
height="2.977777777777778in"}[תרשים]{dir="rtl"} ERD [של מסד הנתונים
המאוחד:]{dir="rtl"}

[תרשים]{dir="rtl"} DSD [של מסד הנתונים המאוחד:]{dir="rtl"}

![](media/image63.png){width="5.768055555555556in"
height="2.7104166666666667in"}

[[תיאור שינוי מסד הנתונים כולל החלטות ופקודות:]{.underline}]{dir="rtl"}

[שלב א: הוספת הטבלה]{dir="rtl"} Room [למסד הנתונים הקיים.]{dir="rtl"}

![](media/image64.png){width="5.768055555555556in"
height="1.7in"}

[שלב ב: נוסיף לטבלת ההזמנות את העמודה]{dir="rtl"}
RoomNumber[:]{dir="rtl"}

![](media/image65.png){width="3.4331550743657044in"
height="0.7055555555555556in"}

[שלב ג: נקשר את טבלת]{dir="rtl"} Reservation [לטבלת]{dir="rtl"}
Room[:]{dir="rtl"}

![](media/image66.png){width="4.663101487314086in"
height="1.21040791776028in"}

[שלב ד: מחיקת העמודה]{dir="rtl"} room_type [מטבלת ההזמנות:]{dir="rtl"}

![](media/image67.png){width="4.063290682414698in"
height="1.2436909448818898in"}

[שלב ה: נעתיק את נתוני]{dir="rtl"} roomNumber [מטבלת]{dir="rtl"} room
[לטבלת]{dir="rtl"} reservation[:]{dir="rtl"}

![](media/image68.png){width="5.768055555555556in"
height="2.620833333333333in"}

**[[יצירת מבטים:]{.underline}]{dir="rtl"}**

[[מבט 1:]{.underline} מבט של ניהול/תפעול חדרים -- איזה חדרים הוזמנו וכמה
פעמים, כולל סוג החדר והקומה.]{dir="rtl"}

![](media/image69.png){width="5.768055555555556in"
height="2.2895833333333333in"}

![](media/image70.png){width="4.381979440069991in"
height="2.9253641732283464in"}[[נתונים מהמבט:]{.underline}]{dir="rtl"}

[[יצירת שתי שאילתות על המבט:]{.underline}]{dir="rtl"}

1.  [הצגת כל החדרים עם 0 הזמנות]{dir="rtl"}

2.  [הצגת סכום ההזמנות לפי קומה, ממוין על פי מספרי הקומות]{dir="rtl"}

![](media/image71.png){width="5.768055555555556in"
height="2.285416666666667in"}

[נתונים מהשאילתות:]{dir="rtl"}

1.  []{dir="rtl"}

> ![תמונה שמכילה טקסט, גופן, צילום מסך, קו תוכן בינה מלאכותית גנרטיבית
> עשוי להיות
> שגוי.](media/image72.png){width="5.768055555555556in"
> height="0.7784809711286089in"}

[(אין חדרים עם 0 הזמנות בנתונים שלנו)]{dir="rtl"}

2.  ![](media/image73.png){width="1.8504582239720035in"
    height="2.8544302274715663in"}

[החלטנו שצריך להוסיף גם טבלת]{dir="rtl"} preferences [שתקשר בין מספר
ההעדפה (בטבלת ההזמנות) לתיאור המילולי שלה.]{dir="rtl"}

![](media/image74.png){width="4.905063429571303in"
height="1.4834481627296587in"}

[נקשר בינה לבין טבלת]{dir="rtl"} reservation[:]{dir="rtl"}

![](media/image75.png){width="5.278480971128609in"
height="1.722211286089239in"}

[[מבט 2:]{.underline} מבט של ניתוח העדפות אורחים -- מה ההעדפות שנבחרו,
וכמה הזמנות בחרו כל אחת.]{dir="rtl"}

![](media/image76.png){width="5.768055555555556in"
height="2.803472222222222in"}

![](media/image77.png){width="2.556961942257218in"
height="2.302833552055993in"}

[[יצירת שתי שאילתות על המבט:]{.underline}]{dir="rtl"}

1.  [ההעדפה הכי פופולרית]{dir="rtl"}

2.  ![](media/image78.png){width="5.768055555555556in"
    height="2.04375in"}[כל ההעדפות עם יותר מ־30 הזמנות]{dir="rtl"}

```{=html}
<!-- -->
```
1)  []{dir="rtl"}

> ![](media/image79.png){width="4.44936789151356in"
> height="0.8731539807524059in"}

2)  []{dir="rtl"}

> ![](media/image80.png){width="4.175557742782153in"
> height="3.107595144356955in"}

**[[שלב 4 -- תכנות:]{.underline}]{dir="rtl"}**

[לפני שהתחלנו את שלב 4, החלטנו שבטבלה]{dir="rtl"} subscription[,
העמודה]{dir="rtl"} membershiplevel [צריכה להיות ברמות של זהב, כסף ונחושת
(ולא מספר 0-9 כמו שהיה עד עכשיו). אז יצרנו קובץ]{dir="rtl"}
alterTable.sql [שעדכן את הערך בטבלה לצורה הנכונה.]{dir="rtl"}

![](media/image81.png){width="5.768055555555556in"
height="1.2104166666666667in"}

[בנוסף, נשנה את הערך של]{dir="rtl"} roomtype [גם לערך מילולי במקום
מספרי:]{dir="rtl"}

![](media/image82.png){width="5.768055555555556in"
height="3.7006944444444443in"}

![](media/image83.png){width="5.411198600174978in"
height="2.2617279090113738in"}

[]{dir="rtl"}

[נבטל את העמודה]{dir="rtl"} incidentType [בטבלה]{dir="rtl"}
incidentreport[:]{dir="rtl"}

![](media/image84.png){width="5.768055555555556in"
height="0.6715277777777777in"}

[ונוסיף לה עמודת]{dir="rtl"} description[:]{dir="rtl"}

![](media/image85.png){width="5.768055555555556in"
height="0.7291666666666666in"}

[(כל השינויים האלה נמצאים בקובץ]{dir="rtl"} alterTable.sql[)]{dir="rtl"}

**[פונקציות:]{dir="rtl"}**

1)  **get_guest_feedbacks(p_gid INTEGER)[:]{dir="rtl"}**

> [**מטרה:** החזרת כל הפידבקים שניתנו על ידי אורח מסוים לפי]{dir="rtl"}
> gid[.]{dir="rtl"}
>
> **[פרמטרים:]{dir="rtl"}**p_gid [-- מזהה האורח.]{dir="rtl"}
>
> **[מחזירה:]{dir="rtl"}**REFCURSOR [שמצביע על כל הדירוגים, התאריכים
> והתיאורים של הפידבקים שכתב האורח.]{dir="rtl"}
>
> ![](media/image86.png){width="5.768055555555556in"
> height="3.104861111111111in"}

[[הפעלת הפונקציה על]{dir="rtl"} gid =
213517251[:]{dir="rtl"}]{.underline}

![](media/image87.png){width="5.768055555555556in"
height="0.29444444444444445in"}

**[2)]{dir="rtl"}**

**get_available_rooms_by_type(desired_type TEXT[,]{dir="rtl"}
desired_check_in DATE[,]{dir="rtl"} desired_check_out DATE)**

[**מטרה:** החזרת חדרים זמינים לפי סוג חדר ותאריכים מבוקשים.]{dir="rtl"}

**[פרמטרים:]{dir="rtl"}**desired_type [-- סוג החדר (כמו
\"]{dir="rtl"}Double\", \"Suite[\").]{dir="rtl"}

desired_check_in, desired_check_out [-- טווח התאריכים.]{dir="rtl"}

**[מחזירה:]{dir="rtl"}** REFCURSOR [שמכיל את כל מספרי החדרים
הפנויים.]{dir="rtl"}

![](media/image88.png){width="5.768055555555556in"
height="3.0791666666666666in"} ![תמונה שמכילה טקסט, צילום מסך, גופן תוכן
בינה מלאכותית גנרטיבית עשוי להיות
שגוי.](media/image89.png){width="5.768055555555556in"
height="2.975in"}

![](media/image90.png){width="3.736111111111111in"
height="3.7152777777777777in"}[הדפסה עבור]{dir="rtl"} Double[, תאריך
כניסה היום +3 ויציאה היום +7:]{dir="rtl"}

**[פרוצדורות:]{dir="rtl"}**

1)  **resolve_old_incidents()[:]{dir="rtl"}**

> [**מטרה:** סימון תלונות לא פתורות]{dir="rtl"} (status = TRUE) [שחלפו
> להן 30 ימים כהודעות שפגו תוקף.]{dir="rtl"}
>
> [**פעולה:** מוסיפה תיאור]{dir="rtl"} \[Auto-expired: not resolved
> within 30 days\][לתלונות ישנות]{dir="rtl"}.

![](media/image91.png){width="5.768055555555556in"
height="3.1618055555555555in"} ![תמונה שמכילה טקסט, צילום מסך, גופן תוכן
בינה מלאכותית גנרטיבית עשוי להיות
שגוי.](media/image92.png){width="5.768055555555556in"
height="3.0006944444444446in"}

![](media/image93.png){width="4.670833333333333in"
height="3.0518438320209973in"}[[מסד הנתונים לפני הפעלת
הפרוצדורה:]{.underline}]{dir="rtl"}

> [[מסד הנתונים לאחר הפעלת הפרוצדורה:]{.underline}]{dir="rtl"}
>
> ![](media/image94.png){width="5.768055555555556in"
> height="2.15in"}
>
> **[2)]{dir="rtl"} reward_high_rating_guests()[:]{dir="rtl"}**
>
> [**מטרה:** הענקת 10 נקודות בונוס לאורחים שכתבו פידבק עם דירוג של 7
> ומעלה]{dir="rtl"}.
>
> ![](media/image95.png){width="5.768055555555556in"
> height="2.7916666666666665in"}![](media/image96.png){width="5.768055555555556in"
> height="3.1527777777777777in"}[**פעולה:** מעדכנת את שדה]{dir="rtl"}
> pointsBalance [בטבלת]{dir="rtl"} subscription[.]{dir="rtl"}

[[מסד הנתונים לפני הפעלת הפרוצדורה:]{.underline}]{dir="rtl"}

![](media/image97.png){width="4.455555555555556in"
height="3.092361111111111in"}

[[מסד הנתונים לאחר הפעלת הפרוצדורה:]{.underline}]{dir="rtl"}

![](media/image98.png){width="4.479166666666667in"
height="2.8027777777777776in"}

**[טריגרים:]{dir="rtl"}**

1)  **[עדכון דרגת מנוי לפי כמות נקודות]{dir="rtl"}**

**[מטרה]{dir="rtl"}: []{dir="rtl"}**[ברגע שיתעדכן מספר הנקודות במנוי,
הדרגה]{dir="rtl"} (level) [תתעדכן בהתאם]{dir="rtl"}:

-   0--20 = \"Basic\"

-   21--60 = \"Silver\"

-   \"gold\" [= 61 ומעלה.]{dir="rtl"}

![](media/image99.png){width="5.768055555555556in"
height="2.8333333333333335in"}[[פונקציית טריגר:]{.underline}]{dir="rtl"}

[[הטריגר:]{.underline}]{dir="rtl"}

![תמונה שמכילה טקסט, גופן, צילום מסך תוכן בינה מלאכותית גנרטיבית עשוי
להיות
שגוי.](media/image100.png){width="5.768055555555556in"
height="1.0090277777777779in"}

[[בדיקה שהטריגר עובד:]{.underline}]{dir="rtl"}

[ניצור שאילתת]{dir="rtl"} UPDATE[, שתעדכן את מספר הנקודות של אורח מסוים
למעל הסף של]{dir="rtl"} GOLD [(כלומר מעל 60), ונבדוק האם ה]{dir="rtl"}
membershiplevel [שלו השתנה בהתאם.]{dir="rtl"}

[[האורח לפני העדכון:]{.underline}]{dir="rtl"}

![](media/image101.png){width="5.511185476815398in"
height="0.3750524934383202in"}

[[קוד העדכון:]{.underline}]{dir="rtl"}

![](media/image102.png){width="5.768055555555556in"
height="0.9388888888888889in"}

[[האורח לאחר העדכון:]{.underline}]{dir="rtl"}

![](media/image103.png){width="5.511185476815398in"
height="0.33338035870516186in"}

2)  **[מילוי אוטומטי של תאריך היום הנוכחי בפידבק]{dir="rtl"}**

[טריגר זה מופעל לפני הכנסת רשומה חדשה לטבלת הפידבקים. אם לא הוזן תאריך
על ידי המשתמש, הטריגר ימלא אוטומטית את שדה התאריך בתאריך של היום
הנוכחי.]{dir="rtl"}

[[פונקציית הטריגר:]{.underline}]{dir="rtl"}

![תמונה שמכילה טקסט, צילום מסך, גופן תוכן בינה מלאכותית גנרטיבית עשוי
להיות
שגוי.](media/image104.png){width="5.768055555555556in"
height="2.2083333333333335in"}

[[הטריגר:]{.underline}]{dir="rtl"}

![](media/image105.png){width="5.768055555555556in"
height="0.9in"}

[[בדיקה שהטריגר עובד:]{.underline}]{dir="rtl"}

[ניצור שאילתת]{dir="rtl"} INSERT [שתכניס פידבק חדש, ללא
תאריך.]{dir="rtl"}

[לפני כן, נוסיף הזמנה חדשה כדי שנוכל לתת עליה פידבק:]{dir="rtl"}

![](media/image106.png){width="5.768055555555556in"
height="0.5645833333333333in"}

![](media/image107.png){width="5.768055555555556in"
height="0.6027777777777777in"}

[לפידבק החדש אין תאריך ולכן לפי הטריגר, התאריך צריך להיות התאריך של היום
(13.7)]{dir="rtl"}

![](media/image108.png){width="5.768055555555556in"
height="0.28402777777777777in"}

**[תוכניות ראשיות:]{dir="rtl"}**

1)  [מפעילה את הפרוצדורה שמעדכנת כל תלונה שעבר לה מעל ל30 יום, ולאחר מכן
    מדפיסה את כל הפידבקים שנכתבו על ידי משתמש מסוים (בדוגמה בקוד פה --
    213517251)**.**]{dir="rtl"}

![](media/image109.png){width="5.768055555555556in"
height="3.1347222222222224in"} ![תמונה שמכילה טקסט, צילום מסך, גופן תוכן
בינה מלאכותית גנרטיבית עשוי להיות
שגוי.](media/image110.png){width="5.768055555555556in"
height="1.1979166666666667in"}

> [[פלט לאחר ההרצה:]{.underline}]{dir="rtl"}
>
> ![תמונה שמכילה טקסט, צילום מסך, גופן, אלגברה תוכן בינה מלאכותית
> גנרטיבית עשוי להיות
> שגוי.](media/image111.png){width="5.768055555555556in"
> height="0.9388888888888889in"}

2)  [מפעילה את הפונקציה שנותנת 10 נקודות בונוס למשתמש שנתן דירוג גבוה
    מ7, ולאחר מכן מראה את כל החדרים הפנויים מהסוג שנכתב (בדוגמה
    שלנו,]{dir="rtl"} Double[), בתאריכים שנבחרו (בדוגמה שלנו, היום +3 עד
    היום+7)]{dir="rtl"}

![תמונה שמכילה טקסט, צילום מסך, גופן תוכן בינה מלאכותית גנרטיבית עשוי
להיות
שגוי.](media/image112.png){width="5.768055555555556in"
height="2.8930555555555557in"}![תמונה שמכילה טקסט, צילום מסך, גופן תוכן
בינה מלאכותית גנרטיבית עשוי להיות
שגוי.](media/image113.png){width="5.768055555555556in"
height="2.061111111111111in"}

![](media/image114.png){width="5.768055555555556in"
height="3.0729166666666665in"}[[פלט לאחר ההרצה:]{.underline}]{dir="rtl"}

> **[[שלב 5 - יצירת ממשק גרפי לעבודה מול בסיס
> הנתונים]{dir="rtl"} :]{.underline}**
>
> [לפני שנתחיל את שלב 5, נשנה כמה דברים בטבלאות כדי שהנתונים יהיו
> מסודרים בצורה הגיונית יותר, ונוכל להתמודד איתם בצורה טובה
> יותר.]{dir="rtl"}
>
> [נשנה את טבלת]{dir="rtl"} check_in_out[, כך שהיא תהיה טבלה מקשרת.
> במקום שכל הזמנה בטבלה]{dir="rtl"} reservation [תכיל]{dir="rtl"} gid[,
> מספר הלקוח יהיה בתוך הטבלה]{dir="rtl"} check_in_out[, שתקשר בין הזמנה
> ללקוח.]{dir="rtl"}
>
> [לשם כך נעשה כמה שלבים:]{dir="rtl"}

1)  [נוסיף את העמודה]{dir="rtl"} gid [לטבלה]{dir="rtl"} check_in_out[,
    ונגדיר שהנתונים שלה מגיעים מטבלת]{dir="rtl"} guest[.]{dir="rtl"}

![](media/image115.png){width="5.709130577427821in"
height="0.645923009623797in"}

2)  [נעתיק את המידע של]{dir="rtl"} gid [מטבלת]{dir="rtl"} reservation
    [לטבלת]{dir="rtl"} check_in_out [לפי]{dir="rtl"} resid
    [מתאים:]{dir="rtl"}

> ![](media/image116.png){width="4.11515748031496in"
> height="1.354355861767279in"}

3)  [נמחק את עמודת]{dir="rtl"} gid [מטבלת]{dir="rtl"}
    reservation[:]{dir="rtl"}

> ![](media/image117.png){width="4.219338363954506in"
> height="0.6146686351706037in"}

4)  [נסמן את עמודת]{dir="rtl"} gid [כחובה (אי אפשר שתהיה הזמנה ללא
    אורח):]{dir="rtl"}

> ![](media/image118.png){width="4.781917104111986in"
> height="0.5834142607174103in"}

[בנוסף, ניצור פרוצדורה חדשה, שכשנרצה להכניס הזמנה חדשה, נצטרך לעבור דרכה
והיא תעדכן גם את טבלת]{dir="rtl"} reservation [וגם את טבלת]{dir="rtl"}
check_in_out[, כדי ששתיהן יהיו מעודכנות כמו שצריך ולא יהיו סתירות
וחוסרים במידע.]{dir="rtl"}

![](media/image119.png){width="5.768055555555556in"
height="2.93125in"} ![תמונה שמכילה טקסט, גופן, צילום מסך תוכן בינה
מלאכותית גנרטיבית עשוי להיות
שגוי.](media/image120.png){width="5.768055555555556in"
height="1.075in"} []{dir="rtl"}

[ונוסיף אלמנט לטבלת]{dir="rtl"} reservation[, שכאשר נכנסת הזמנה חדשה,
נוצר לה]{dir="rtl"} resid [סריאלי.]{dir="rtl"}

![](media/image121.png){width="5.768055555555556in"
height="0.4625in"}

[(ביקשנו להתחיל מ9999 כי יש כבר ערכים בטבלה ולכן נמשיך סריאלית מהמספר
הגבוה ביותר שקיים בה כרגע כדי שלא יהיו התנגשויות).]{dir="rtl"}

[ונוסיף גם פרוצדורה למחיקת הזמנה משתי הטבלאות:]{dir="rtl"}

![](media/image122.png){width="5.768055555555556in"
height="2.4in"}

[[כעת נתחיל בבנייה ועיצוב של הממשק הגרפי:]{.underline}]{dir="rtl"}

[כל המסכים נבנו בעזרת]{dir="rtl"} python [ו]{dir="rtl"}
TKINTER[.]{dir="rtl"}

![](media/image123.png){width="3.884027777777778in"
height="2.436111111111111in"}[לפני שהמסך הראשי מתחיל לפעול, בנינו קוד
נפרד (קובץ]{dir="rtl"} (db.py [לחיבור של המערכת למסדר הנתונים. כל מסך
שצריך לגשת למסד הנתונים, ייבא את הקוד ויתחבר כך למסד
הנתונים.]{dir="rtl"}

**[[הכלים שבהם השתמשנו:]{.underline}]{dir="rtl"}**

[-]{dir="rtl"} Python [- שפת הפיתוח העיקרית של המערכת.]{dir="rtl"}

[-]{dir="rtl"} Tkinter [- ספריית]{dir="rtl"} GUI [מובנית
ב־]{dir="rtl"}Python [ליצירת הממשק הגרפי.]{dir="rtl"}

[-]{dir="rtl"} psycopg2 [- ספרייה לחיבור למסד נתונים]{dir="rtl"}
PostgreSQL [מתוך]{dir="rtl"} Python[.]{dir="rtl"}

[-]{dir="rtl"} PostgreSQL[- מסד הנתונים של המערכת.]{dir="rtl"}

[-]{dir="rtl"} PyCharm [- סביבת העבודה שבה פותחה האפליקציה.]{dir="rtl"}

**[[קבצי המערכת ותפקידם]{.underline}]{dir="rtl"}**

[- \`]{dir="rtl"}hotel_app.py[\` - המסך הראשי שמרכז את כל הגישה למסכים
האחרים.]{dir="rtl"}

[- \`]{dir="rtl"}reservation_screen.py[\` - מסך שמוביל למסכי ניהול
הזמנות.]{dir="rtl"}

[-]{dir="rtl"} \'new_reservation_screen.py\' [-- מסך להכנסת הזמנה
חדשה.]{dir="rtl"}

[-]{dir="rtl"} \'delete_reservation_screen.py\' [-- מסך למחיקת הזמנה
קיימת.]{dir="rtl"}

[-]{dir="rtl"} \'show_all_reservations.py\' [-- מסך להצגת כל ההזמנות
הקיימות.]{dir="rtl"}

[- \`]{dir="rtl"}incidents_screen.py[\` - ניהול תלונות: סינון, מחיקה,
עדכון.]{dir="rtl"}

[- \`]{dir="rtl"}feedback_screen.py[\` - ניהול פידבקים והפעלת
פרוצדורות.]{dir="rtl"}

[- \`]{dir="rtl"}db.py[\` -- קובץ העזר להתחברות למסד
הנתונים.]{dir="rtl"}

1)  [**מסך ראשי**:]{dir="rtl"}

> [המסך הראשי הוא המסך ממנו נגיע לכל אחת מהאפשרויות האחרות במערכת. המסך
> הראשי יכלול 3 כפתורים, בהתאם ל3 חלקי הניהול של המערכת:]{dir="rtl"}

[ניהול הזמנות, ניהול תלונות, וניהול פידבקים.]{dir="rtl"}

![](media/image124.png){width="2.8085214348206473in"
height="3.0262784339457567in"}

2)  **[מסך ניהול הזמנות:]{dir="rtl"}**

![](media/image125.png){width="2.8974343832021in"
height="3.121386701662292in"}[לאחר שנלחץ על כפתור \"ניהול הזמנות\", נגיע
למסך שבו יש מספר אפשרויות.]{dir="rtl"}

3)  **[מסך יצירת הזמנה:]{dir="rtl"}**

> ![](media/image126.png){width="3.3256944444444443in"
> height="3.323611111111111in"}[במסך יצירת הזמנה, נוכל ליצור הזמנה
> חדשה.]{dir="rtl"}
>
> [מסך זה משתמש במספר דברים ממס הנתונים שלנו.]{dir="rtl"}
>
> [לפני שהלקוח בוחר את החדר המועדף עליו, הוא ממלא את סוג החדר, ואת
> תאריכי הכניסה והיציאה, ולאחר מכן לוחץ על \"עדכן רשימת חדרים פנויים\".
> לחיצה על כפתור זה, מפעילה את הפרוצדורה שבנינו בשלב 4
> (]{dir="rtl"}(get_available_rooms_by_type[, שמחזירה]{dir="rtl"} Ref
> Cursor [עם מספרי החדרים הפנויים מהסוג הזה בתאריכים שנבחרו.]{dir="rtl"}
>
> [מכיוון שהטבלה]{dir="rtl"} check_in_out [היא טבלה מקשרת (בין מספר לקוח
> למספר הזמנה, ומוסיפה לו תאריכי כניסה ויציאה), אז נצטרך לעדכן כל הזמנה
> גם בטבלה]{dir="rtl"} reservation [וגם בטבלה המקשרת]{dir="rtl"}
> check_in_out[.]{dir="rtl"}
>
> [לשם כך השתמשנו בפרוצדורה שבנינו בתחילת השלב הנוכחי
> (]{dir="rtl"}(add_reservation_with_guest[, שמעדכנת את שתי הטבלאות בכל
> הכנסה.]{dir="rtl"}
>
> [בנוסף, המערכת תבדוק האם מספר הלקוח קיים בטבלה]{dir="rtl"}
> guest[.]{dir="rtl"}
>
> [אם כל המידע נכון והחדר פנוי, המערכת תעדכן את הטבלאות המתאימות במסד
> הנתונים ותיתן הודעת אישור.]{dir="rtl"}

4)  ![](media/image127.png){width="3.089583333333333in"
    height="1.7166666666666666in"}**[מסך מחיקת הזמנה:]{dir="rtl"}**

> [גם פה השתמשנו בפרוצדורה שיצרנו בתחילת השלב
> (]{dir="rtl"}delete_reservation[), שמוחקת את ההזמנה גם
> מטבלת]{dir="rtl"} reservation [וגם מטבלת]{dir="rtl"} check_in_out[.
> לאחר לחיצה על כפתור המחיקה, המערכת תשאל את המשתמש \"האם אתה בטוח
> שברצונך למחוק את הזמנה מספר (מספר ההזמנה)?\". כך נמנע טעויות בלתי
> הפיכות בשימוש במסד הנתונים.]{dir="rtl"}

5)  **[מסך הצגת כל ההזמנות:]{dir="rtl"}**

> ![](media/image128.png){width="5.074305555555555in"
> height="2.872916666666667in"}[מפעיל שאילתא שמציגה את כל ההזמנות שיש
> במערכת, כולל סוג החדר, מספר הזמנה, מספר הלקוח, ותאריך כניסה
> ויציאה.]{dir="rtl"}

6)  **[מסך ניהול תלונות:]{dir="rtl"}**

> [במסך ניהול התלונות, נוכל לראות את כל התלונות שמופיעות במערכת, מספר
> הלקוח המתלונן, תאריך דיווח וסטטוס.]{dir="rtl"}
>
> [במסך יש מספר אפשרויות:]{dir="rtl"}

-   [טען תקריות: מרענן את רשימת התקריות]{dir="rtl"}

-   [מחק תקריות שקיימות מעל שנה: מפעיל את השאילתא שכתבנו בשלב 2, שמוחקת
    תקריות שהתאריך שלהן הוא למעלה משנה (מכיוון שהשאילתא לא מתאימה במדויק
    למסד נתונים אחרי האינטגרציה והעדכונים, כתבנו אותה מחדש
    בקוד).]{dir="rtl"}

-   ![](media/image129.png){width="5.768055555555556in"
    height="3.598611111111111in"}[סגור תקריות פתוחות מעל 30 יום: מפעיל
    את הפרוצדורה משלב 4 (]{dir="rtl"}(resolve_old_incidents[, שמוסיפה
    הערה בתיאור של כל תלונה שפתוחה מעל 30 יום]{dir="rtl"}

7)  **[מסך ניהול פידבקים:]{dir="rtl"}**

> [במסך קיימות מספר אפשרויות:]{dir="rtl"}

-   [הצגת כל הפידבקים שקיימים במערכת]{dir="rtl"}

-   [שימוש בשאילתא משלב 2, שמציג את רשימת כל הפידבקים עם דירוג מתחת ל3
    (גם כאן, כתבנו את השאילתא בצורה מעודכנת בתוך הקוד כדי שתתאים במדויק
    לשינויים בפרוייקט)]{dir="rtl"}

-   [בדיקת פידבקים של אורח -- שימוש בפונקציה שכתבנו בשלב 4
    (]{dir="rtl"}get_guest_feedbacks[), שמקבלת]{dir="rtl"} gid [של אורח
    ומחזירה]{dir="rtl"} Ref Cursor [של כל הפידבקים שהאורח
    כתב.]{dir="rtl"}

-   [הענקת נקודות בונוס -- שימוש בפרוצדורה שכתבנו בשלב 4
    (]{dir="rtl"}(reward_high_rating_guests [שמעניקה 10 נקודות בונוס לכל
    לקוח שנתן דירוג שגבוה מ7.]{dir="rtl"}

![](media/image130.png){width="4.2131430446194225in"
height="3.2590234033245844in"}
